import{AsyncLocalStorage as ur}from"node:async_hooks";import"node:fs/promises";import"node:path";function fr(){const{process:e,Deno:t}=globalThis;return!(typeof t?.noColor=="boolean"?t.noColor:e!==void 0?"NO_COLOR"in e?.env:!1)}var $e="__COMPOSED_HANDLER",bt=e=>e.length>1,Et=e=>e[$e]?Et(e[$e]):e,hr=e=>e.name||(bt(e)?"[middleware]":"[handler]"),dr=e=>e.routes.map(({path:t,method:r,handler:n})=>{const s=Et(n);return{path:t,method:r,name:hr(s),isMiddleware:bt(s)}}),pr=(e,t)=>{const r=fr(),n={};let s=0,i=0;dr(e).filter(({isMiddleware:o})=>!o).map(o=>{const l=`${o.method}-${o.path}`;if((n[l]||=[]).push(o),!(n[l].length>1))return s=Math.max(s,o.method.length),i=Math.max(i,o.path.length),{method:o.method,path:o.path,routes:n[l]}}).forEach(o=>{if(!o)return;const{method:l,path:c,routes:a}=o,f=r?`\x1B[32m${l}\x1B[0m`:l;console.log(`${f} ${" ".repeat(s-l.length)} ${c}`)})},wt={Stringify:1},L=(e,t)=>{const r=new String(e);return r.isEscaped=!0,r.callbacks=t,r},gr=/[&<>'"]/,Rt=async(e,t)=>{let r="";t||=[];const n=await Promise.all(e);for(let s=n.length-1;r+=n[s],s--,!(s<0);s--){let i=n[s];typeof i=="object"&&t.push(...i.callbacks||[]);const o=i.isEscaped;if(i=await(typeof i=="object"?i.toString():i),typeof i=="object"&&t.push(...i.callbacks||[]),i.isEscaped??o)r+=i;else{const l=[r];q(i,l),r=l[0]}}return L(r,t)},q=(e,t)=>{const r=e.search(gr);if(r===-1){t[0]+=e;return}let n,s,i=0;for(s=r;s<e.length;s++){switch(e.charCodeAt(s)){case 34:n="&quot;";break;case 39:n="&#39;";break;case 38:n="&amp;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}t[0]+=e.substring(i,s)+n,i=s+1}t[0]+=e.substring(i,s)},St=e=>{const t=e.callbacks;if(!t?.length)return e;const r=[e],n={};return t.forEach(s=>s({phase:wt.Stringify,buffer:r,context:n})),r[0]},Ot=async(e,t,r,n,s)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));const i=e.callbacks;return i?.length?(s?s[0]+=e:s=[e],Promise.all(i.map(l=>l({phase:t,buffer:s,context:n}))).then(l=>Promise.all(l.filter(Boolean).map(c=>Ot(c,t,!1,n,s))).then(()=>s[0]))):Promise.resolve(e)},vr=(e,...t)=>{const r=[""];for(let n=0,s=e.length-1;n<s;n++){r[0]+=e[n];const i=Array.isArray(t[n])?t[n].flat(1/0):[t[n]];for(let o=0,l=i.length;o<l;o++){const c=i[o];if(typeof c=="string")q(c,r);else if(typeof c=="number")r[0]+=c;else{if(typeof c=="boolean"||c===null||c===void 0)continue;if(typeof c=="object"&&c.isEscaped)if(c.callbacks)r.unshift("",c);else{const a=c.toString();a instanceof Promise?r.unshift("",a):r[0]+=a}else c instanceof Promise?r.unshift("",c):q(c.toString(),r)}}}return r[0]+=e.at(-1),r.length===1?"callbacks"in r?L(St(L(r[0],r.callbacks))):L(r[0]):Rt(r,r.callbacks)},Be=Symbol("RENDERER"),Ne=Symbol("ERROR_HANDLER"),A=Symbol("STASH"),xt=Symbol("INTERNAL"),yr=Symbol("MEMO"),be=Symbol("PERMALINK"),tt=e=>(e[xt]=!0,e),At=e=>({value:t,children:r})=>{if(!r)return;const n={children:[{tag:tt(()=>{e.push(t)}),props:{}}]};Array.isArray(r)?n.children.push(...r.flat()):n.children.push(r),n.children.push({tag:tt(()=>{e.pop()}),props:{}});const s={tag:"",props:n,type:""};return s[Ne]=i=>{throw e.pop(),i},s},Pt=e=>{const t=[e],r=At(t);return r.values=t,r.Provider=r,V.push(r),r},V=[],We=e=>{const t=[e],r=(n=>{t.push(n.value);let s;try{s=n.children?(Array.isArray(n.children)?new _t("",{},n.children):n.children).toString():""}catch(i){throw t.pop(),i}return s instanceof Promise?s.finally(()=>t.pop()).then(i=>L(i,i.callbacks)):(t.pop(),L(s))});return r.values=t,r.Provider=r,r[Be]=At(t),V.push(r),r},Z=e=>e.values.at(-1),he={title:[],script:["src"],style:["data-href"],link:["href"],meta:["name","httpEquiv","charset","itemProp"]},De={},de="data-precedence",oe=e=>Array.isArray(e)?e:[e],rt=new WeakMap,nt=(e,t,r,n)=>({buffer:s,context:i})=>{if(!s)return;const o=rt.get(i)||{};rt.set(i,o);const l=o[e]||=[];let c=!1;const a=he[e];if(a.length>0){e:for(const[,f]of l)for(const u of a)if((f?.[u]??null)===r?.[u]){c=!0;break e}}if(c?s[0]=s[0].replaceAll(t,""):a.length>0?l.push([t,r,n]):l.unshift([t,r,n]),s[0].indexOf("</head>")!==-1){let f;if(n===void 0)f=l.map(([u])=>u);else{const u=[];f=l.map(([h,,p])=>{let E=u.indexOf(p);return E===-1&&(u.push(p),E=u.length-1),[h,E]}).sort((h,p)=>h[1]-p[1]).map(([h])=>h)}f.forEach(u=>{s[0]=s[0].replaceAll(u,"")}),s[0]=s[0].replace(/(?=<\/head>)/,f.join(""))}},ae=(e,t,r)=>L(new H(e,r,oe(t??[])).toString()),le=(e,t,r,n)=>{if("itemProp"in r)return ae(e,t,r);let{precedence:s,blocking:i,...o}=r;s=n?s??"":void 0,n&&(o[de]=s);const l=new H(e,o,oe(t||[])).toString();return l instanceof Promise?l.then(c=>L(l,[...c.callbacks||[],nt(e,c,o,s)])):L(l,[nt(e,l,o,s)])},mr=({children:e,...t})=>{const r=Ue();if(r){const n=Z(r);if(n==="svg"||n==="head")return new H("title",t,oe(e??[]))}return le("title",e,t,!1)},br=({children:e,...t})=>{const r=Ue();return["src","async"].some(n=>!t[n])||r&&Z(r)==="head"?ae("script",e,t):le("script",e,t,!1)},Er=({children:e,...t})=>["href","precedence"].every(r=>r in t)?(t["data-href"]=t.href,delete t.href,le("style",e,t,!0)):ae("style",e,t),wr=({children:e,...t})=>["onLoad","onError"].some(r=>r in t)||t.rel==="stylesheet"&&(!("precedence"in t)||"disabled"in t)?ae("link",e,t):le("link",e,t,"precedence"in t),Rr=({children:e,...t})=>{const r=Ue();return r&&Z(r)==="head"?ae("meta",e,t):le("meta",e,t,!1)},kt=(e,{children:t,...r})=>new H(e,r,oe(t??[])),Sr=e=>(typeof e.action=="function"&&(e.action=be in e.action?e.action[be]:void 0),kt("form",e)),jt=(e,t)=>(typeof t.formAction=="function"&&(t.formAction=be in t.formAction?t.formAction[be]:void 0),kt(e,t)),Or=e=>jt("input",e),xr=e=>jt("button",e);const Se=Object.freeze(Object.defineProperty({__proto__:null,button:xr,form:Sr,input:Or,link:wr,meta:Rr,script:br,style:Er,title:mr},Symbol.toStringTag,{value:"Module"}));var Ar=new Map([["className","class"],["htmlFor","for"],["crossOrigin","crossorigin"],["httpEquiv","http-equiv"],["itemProp","itemprop"],["fetchPriority","fetchpriority"],["noModule","nomodule"],["formAction","formaction"]]),Ee=e=>Ar.get(e)||e,Ct=(e,t)=>{for(const[r,n]of Object.entries(e)){const s=r[0]==="-"||!/[A-Z]/.test(r)?r:r.replace(/[A-Z]/g,i=>`-${i.toLowerCase()}`);t(s,n==null?null:typeof n=="number"?s.match(/^(?:a|border-im|column(?:-c|s)|flex(?:$|-[^b])|grid-(?:ar|[^a])|font-w|li|or|sca|st|ta|wido|z)|ty$/)?`${n}`:`${n}px`:n)}},ne=void 0,Ue=()=>ne,Pr=e=>/[A-Z]/.test(e)&&e.match(/^(?:al|basel|clip(?:Path|Rule)$|co|do|fill|fl|fo|gl|let|lig|i|marker[EMS]|o|pai|pointe|sh|st[or]|text[^L]|tr|u|ve|w)/)?e.replace(/([A-Z])/g,"-$1").toLowerCase():e,kr=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],jr=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","download","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Ke=(e,t)=>{for(let r=0,n=e.length;r<n;r++){const s=e[r];if(typeof s=="string")q(s,t);else{if(typeof s=="boolean"||s===null||s===void 0)continue;s instanceof H?s.toStringToBuffer(t):typeof s=="number"||s.isEscaped?t[0]+=s:s instanceof Promise?t.unshift("",s):Ke(s,t)}}},H=class{tag;props;key;children;isEscaped=!0;localContexts;constructor(e,t,r){this.tag=e,this.props=t,this.children=r}get type(){return this.tag}get ref(){return this.props.ref||null}toString(){const e=[""];this.localContexts?.forEach(([t,r])=>{t.values.push(r)});try{this.toStringToBuffer(e)}finally{this.localContexts?.forEach(([t])=>{t.values.pop()})}return e.length===1?"callbacks"in e?St(L(e[0],e.callbacks)).toString():e[0]:Rt(e,e.callbacks)}toStringToBuffer(e){const t=this.tag,r=this.props;let{children:n}=this;e[0]+=`<${t}`;const s=ne&&Z(ne)==="svg"?i=>Pr(Ee(i)):i=>Ee(i);for(let[i,o]of Object.entries(r))if(i=s(i),i!=="children"){if(i==="style"&&typeof o=="object"){let l="";Ct(o,(c,a)=>{a!=null&&(l+=`${l?";":""}${c}:${a}`)}),e[0]+=' style="',q(l,e),e[0]+='"'}else if(typeof o=="string")e[0]+=` ${i}="`,q(o,e),e[0]+='"';else if(o!=null)if(typeof o=="number"||o.isEscaped)e[0]+=` ${i}="${o}"`;else if(typeof o=="boolean"&&jr.includes(i))o&&(e[0]+=` ${i}=""`);else if(i==="dangerouslySetInnerHTML"){if(n.length>0)throw new Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");n=[L(o.__html)]}else if(o instanceof Promise)e[0]+=` ${i}="`,e.unshift('"',o);else if(typeof o=="function"){if(!i.startsWith("on")&&i!=="ref")throw new Error(`Invalid prop '${i}' of type 'function' supplied to '${t}'.`)}else e[0]+=` ${i}="`,q(o.toString(),e),e[0]+='"'}if(kr.includes(t)&&n.length===0){e[0]+="/>";return}e[0]+=">",Ke(n,e),e[0]+=`</${t}>`}},Oe=class extends H{toStringToBuffer(e){const{children:t}=this,r={...this.props};t.length&&(r.children=t.length===1?t[0]:t);const n=this.tag.call(null,r);if(!(typeof n=="boolean"||n==null))if(n instanceof Promise)if(V.length===0)e.unshift("",n);else{const s=V.map(i=>[i,i.values.at(-1)]);e.unshift("",n.then(i=>(i instanceof H&&(i.localContexts=s),i)))}else n instanceof H?n.toStringToBuffer(e):typeof n=="number"||n.isEscaped?(e[0]+=n,n.callbacks&&(e.callbacks||=[],e.callbacks.push(...n.callbacks))):q(n,e)}},_t=class extends H{toStringToBuffer(e){Ke(this.children,e)}},st=(e,t,...r)=>{t??={},r.length&&(t.children=r.length===1?r[0]:r);const n=t.key;delete t.key;const s=pe(e,t,r);return s.key=n,s},it=!1,pe=(e,t,r)=>{if(!it){for(const n in De)Se[n][Be]=De[n];it=!0}return typeof e=="function"?new Oe(e,t,r):Se[e]?new Oe(Se[e],t,r):e==="svg"||e==="head"?(ne||=We(""),new H(e,t,[new Oe(ne,{value:e},r)])):new H(e,t,r)},ze=({children:e})=>new _t("",{children:e},Array.isArray(e)?e:e?[e]:[]);function C(e,t,r){let n;if(!t||!("children"in t))n=pe(e,t,[]);else{const s=t.children;n=Array.isArray(s)?pe(e,t,s):pe(e,t,[s])}return n.key=r,n}var se="_hp",Cr={Change:"Input",DoubleClick:"DblClick"},_r={svg:"2000/svg",math:"1998/Math/MathML"},ie=[],Le=new WeakMap,X=void 0,Mr=()=>X,F=e=>"t"in e,xe={onClick:["click",!1]},ot=e=>{if(!e.startsWith("on"))return;if(xe[e])return xe[e];const t=e.match(/^on([A-Z][a-zA-Z]+?(?:PointerCapture)?)(Capture)?$/);if(t){const[,r,n]=t;return xe[e]=[(Cr[r]||r).toLowerCase(),!!n]}},at=(e,t)=>X&&e instanceof SVGElement&&/[A-Z]/.test(t)&&(t in e.style||t.match(/^(?:o|pai|str|u|ve)/))?t.replace(/([A-Z])/g,"-$1").toLowerCase():t,Tr=(e,t,r)=>{t||={};for(let n in t){const s=t[n];if(n!=="children"&&(!r||r[n]!==s)){n=Ee(n);const i=ot(n);if(i){if(r?.[n]!==s&&(r&&e.removeEventListener(i[0],r[n],i[1]),s!=null)){if(typeof s!="function")throw new Error(`Event handler for "${n}" is not a function`);e.addEventListener(i[0],s,i[1])}}else if(n==="dangerouslySetInnerHTML"&&s)e.innerHTML=s.__html;else if(n==="ref"){let o;typeof s=="function"?o=s(e)||(()=>s(null)):s&&"current"in s&&(s.current=e,o=()=>s.current=null),Le.set(e,o)}else if(n==="style"){const o=e.style;typeof s=="string"?o.cssText=s:(o.cssText="",s!=null&&Ct(s,o.setProperty.bind(o)))}else{if(n==="value"){const l=e.nodeName;if(l==="INPUT"||l==="TEXTAREA"||l==="SELECT"){if(e.value=s==null||s===!1?null:s,l==="TEXTAREA"){e.textContent=s;continue}else if(l==="SELECT"){e.selectedIndex===-1&&(e.selectedIndex=0);continue}}}else(n==="checked"&&e.nodeName==="INPUT"||n==="selected"&&e.nodeName==="OPTION")&&(e[n]=s);const o=at(e,n);s==null||s===!1?e.removeAttribute(o):s===!0?e.setAttribute(o,""):typeof s=="string"||typeof s=="number"?e.setAttribute(o,s):e.setAttribute(o,s.toString())}}}if(r)for(let n in r){const s=r[n];if(n!=="children"&&!(n in t)){n=Ee(n);const i=ot(n);i?e.removeEventListener(i[0],s,i[1]):n==="ref"?Le.get(e)?.():e.removeAttribute(at(e,n))}}},$r=(e,t)=>{t[A][0]=0,ie.push([e,t]);const r=t.tag[Be]||t.tag,n=r.defaultProps?{...r.defaultProps,...t.props}:t.props;try{return[r.call(null,n)]}finally{ie.pop()}},Mt=(e,t,r,n,s)=>{e.vR?.length&&(n.push(...e.vR),delete e.vR),typeof e.tag=="function"&&e[A][1][Dt]?.forEach(i=>s.push(i)),e.vC.forEach(i=>{if(F(i))r.push(i);else if(typeof i.tag=="function"||i.tag===""){i.c=t;const o=r.length;if(Mt(i,t,r,n,s),i.s){for(let l=o;l<r.length;l++)r[l].s=!0;i.s=!1}}else r.push(i),i.vR?.length&&(n.push(...i.vR),delete i.vR)})},Nr=e=>{for(;e&&(e.tag===se||!e.e);)e=e.tag===se||!e.vC?.[0]?e.nN:e.vC[0];return e?.e},Tt=e=>{F(e)||(e[A]?.[1][Dt]?.forEach(t=>t[2]?.()),Le.get(e.e)?.(),e.p===2&&e.vC?.forEach(t=>t.p=2),e.vC?.forEach(Tt)),e.p||(e.e?.remove(),delete e.e),typeof e.tag=="function"&&(Q.delete(e),ge.delete(e),delete e[A][3],e.a=!0)},$t=(e,t,r)=>{e.c=t,Nt(e,t,r)},lt=(e,t)=>{if(t){for(let r=0,n=e.length;r<n;r++)if(e[r]===t)return r}},ct=Symbol(),Nt=(e,t,r)=>{const n=[],s=[],i=[];Mt(e,t,n,s,i),s.forEach(Tt);const o=r?void 0:t.childNodes;let l,c=null;if(r)l=-1;else if(!o.length)l=0;else{const a=lt(o,Nr(e.nN));a!==void 0?(c=o[a],l=a):l=lt(o,n.find(f=>f.tag!==se&&f.e)?.e)??-1,l===-1&&(r=!0)}for(let a=0,f=n.length;a<f;a++,l++){const u=n[a];let h;if(u.s&&u.e)h=u.e,u.s=!1;else{const p=r||!u.e;F(u)?(u.e&&u.d&&(u.e.textContent=u.t),u.d=!1,h=u.e||=document.createTextNode(u.t)):(h=u.e||=u.n?document.createElementNS(u.n,u.tag):document.createElement(u.tag),Tr(h,u.props,u.pP),Nt(u,h,p))}u.tag===se?l--:r?h.parentNode||t.appendChild(h):o[l]!==h&&o[l-1]!==h&&(o[l+1]===h?t.appendChild(o[l]):t.insertBefore(h,c||o[l]||null))}if(e.pP&&(e.pP=void 0),i.length){const a=[],f=[];i.forEach(([,u,,h,p])=>{u&&a.push(u),h&&f.push(h),p?.()}),a.forEach(u=>u()),f.length&&requestAnimationFrame(()=>{f.forEach(u=>u())})}},Dr=(e,t)=>!!(e&&e.length===t.length&&e.every((r,n)=>r[1]===t[n][1])),ge=new WeakMap,Ie=(e,t,r)=>{const n=!r&&t.pC;r&&(t.pC||=t.vC);let s;try{r||=typeof t.tag=="function"?$r(e,t):oe(t.props.children),r[0]?.tag===""&&r[0][Ne]&&(s=r[0][Ne],e[5].push([e,s,t]));const i=n?[...t.pC]:t.vC?[...t.vC]:void 0,o=[];let l;for(let c=0;c<r.length;c++){Array.isArray(r[c])&&r.splice(c,1,...r[c].flat());let a=Lr(r[c]);if(a){typeof a.tag=="function"&&!a.tag[xt]&&(V.length>0&&(a[A][2]=V.map(u=>[u,u.values.at(-1)])),e[5]?.length&&(a[A][3]=e[5].at(-1)));let f;if(i&&i.length){const u=i.findIndex(F(a)?h=>F(h):a.key!==void 0?h=>h.key===a.key&&h.tag===a.tag:h=>h.tag===a.tag);u!==-1&&(f=i[u],i.splice(u,1))}if(f)if(F(a))f.t!==a.t&&(f.t=a.t,f.d=!0),a=f;else{const u=f.pP=f.props;if(f.props=a.props,f.f||=a.f||t.f,typeof a.tag=="function"){const h=f[A][2];f[A][2]=a[A][2]||[],f[A][3]=a[A][3],!f.f&&((f.o||f)===a.o||f.tag[yr]?.(u,f.props))&&Dr(h,f[A][2])&&(f.s=!0)}a=f}else if(!F(a)&&X){const u=Z(X);u&&(a.n=u)}if(!F(a)&&!a.s&&(Ie(e,a),delete a.f),o.push(a),l&&!l.s&&!a.s)for(let u=l;u&&!F(u);u=u.vC?.at(-1))u.nN=a;l=a}}t.vR=n?[...t.vC,...i||[]]:i||[],t.vC=o,n&&delete t.pC}catch(i){if(t.f=!0,i===ct){if(s)return;throw i}const[o,l,c]=t[A]?.[3]||[];if(l){const a=()=>ve([0,!1,e[2]],c),f=ge.get(c)||[];f.push(a),ge.set(c,f);const u=l(i,()=>{const h=ge.get(c);if(h){const p=h.indexOf(a);if(p!==-1)return h.splice(p,1),a()}});if(u){if(e[0]===1)e[1]=!0;else if(Ie(e,c,[u]),(l.length===1||e!==o)&&c.c){$t(c,c.c,!1);return}throw ct}}throw i}finally{s&&e[5].pop()}},Lr=e=>{if(!(e==null||typeof e=="boolean")){if(typeof e=="string"||typeof e=="number")return{t:e.toString(),d:!0};if("vR"in e&&(e={tag:e.tag,props:e.props,key:e.key,f:e.f,type:e.tag,ref:e.props.ref,o:e.o||e}),typeof e.tag=="function")e[A]=[0,[]];else{const t=_r[e.tag];t&&(X||=Pt(""),e.props.children=[{tag:X,props:{value:e.n=`http://www.w3.org/${t}`,children:e.props.children}}])}return e}},ut=(e,t)=>{t[A][2]?.forEach(([r,n])=>{r.values.push(n)});try{Ie(e,t,void 0)}catch{return}if(t.a){delete t.a;return}t[A][2]?.forEach(([r])=>{r.values.pop()}),(e[0]!==1||!e[1])&&$t(t,t.c,!1)},Q=new WeakMap,ft=[],ve=async(e,t)=>{e[5]||=[];const r=Q.get(t);r&&r[0](void 0);let n;const s=new Promise(i=>n=i);if(Q.set(t,[n,()=>{e[2]?e[2](e,t,i=>{ut(i,t)}).then(()=>n(t)):(ut(e,t),n(t))}]),ft.length)ft.at(-1).add(t);else{await Promise.resolve();const i=Q.get(t);i&&(Q.delete(t),i[1]())}return s},Ir=(e,t,r)=>({tag:se,props:{children:e},key:r,e:t,p:1}),Hr=0,Dt=1,Fr=2,qr=3,Ae=new WeakMap,Lt=(e,t)=>!e||!t||e.length!==t.length||t.some((r,n)=>r!==e[n]),Br=void 0,ht=[],Wr=e=>{const t=()=>typeof e=="function"?e():e,r=ie.at(-1);if(!r)return[t(),()=>{}];const[,n]=r,s=n[A][1][Hr]||=[],i=n[A][0]++;return s[i]||=[t(),o=>{const l=Br,c=s[i];if(typeof o=="function"&&(o=o(c[0])),!Object.is(o,c[0]))if(c[0]=o,ht.length){const[a,f]=ht.at(-1);Promise.all([a===3?n:ve([a,!1,l],n),f]).then(([u])=>{if(!u||!(a===2||a===3))return;const h=u.vC;requestAnimationFrame(()=>{setTimeout(()=>{h===u.vC&&ve([a===3?1:0,!1,l],u)})})})}else ve([0,!1,l],n)}]},Ge=(e,t)=>{const r=ie.at(-1);if(!r)return e;const[,n]=r,s=n[A][1][Fr]||=[],i=n[A][0]++,o=s[i];return Lt(o?.[1],t)?s[i]=[e,t]:e=s[i][0],e},Ur=e=>{const t=Ae.get(e);if(t){if(t.length===2)throw t[1];return t[0]}throw e.then(r=>Ae.set(e,[r]),r=>Ae.set(e,[void 0,r])),e},Kr=(e,t)=>{const r=ie.at(-1);if(!r)return e();const[,n]=r,s=n[A][1][qr]||=[],i=n[A][0]++,o=s[i];return Lt(o?.[1],t)&&(s[i]=[e(),t]),s[i][0]},zr=Pt({pending:!1,data:null,method:null,action:null}),dt=new Set,Gr=e=>{dt.add(e),e.finally(()=>dt.delete(e))},Ve=(e,t)=>Kr(()=>r=>{let n;e&&(typeof e=="function"?n=e(r)||(()=>{e(null)}):e&&"current"in e&&(e.current=r,n=()=>{e.current=null}));const s=t(r);return()=>{s?.(),n?.()}},[e]),pt=Object.create(null),gt=Object.create(null),ce=(e,t,r,n,s)=>{if(t?.itemProp)return{tag:e,props:t,type:e,ref:t.ref};const i=document.head;let{onLoad:o,onError:l,precedence:c,blocking:a,...f}=t,u=null,h=!1;const p=he[e];let E;if(p.length>0){const x=i.querySelectorAll(e);e:for(const S of x)for(const d of he[e])if(S.getAttribute(d)===t[d]){u=S;break e}if(!u){const S=p.reduce((d,g)=>t[g]===void 0?d:`${d}-${g}-${t[g]}`,e);h=!gt[S],u=gt[S]||=(()=>{const d=document.createElement(e);for(const g of p)t[g]!==void 0&&d.setAttribute(g,t[g]),t.rel&&d.setAttribute("rel",t.rel);return d})()}}else E=i.querySelectorAll(e);c=n?c??"":void 0,n&&(f[de]=c);const v=Ge(x=>{if(p.length>0){let S=!1;for(const d of i.querySelectorAll(e)){if(S&&d.getAttribute(de)!==c){i.insertBefore(x,d);return}d.getAttribute(de)===c&&(S=!0)}i.appendChild(x)}else if(E){let S=!1;for(const d of E)if(d===x){S=!0;break}S||i.insertBefore(x,i.contains(E[0])?E[0]:i.querySelector(e)),E=void 0}},[c]),P=Ve(t.ref,x=>{const S=p[0];if(r===2&&(x.innerHTML=""),(h||E)&&v(x),!l&&!o)return;let d=pt[x.getAttribute(S)]||=new Promise((g,O)=>{x.addEventListener("load",g),x.addEventListener("error",O)});o&&(d=d.then(o)),l&&(d=d.catch(l)),d.catch(()=>{})});if(s&&a==="render"){const x=he[e][0];if(t[x]){const S=t[x],d=pt[S]||=new Promise((g,O)=>{v(u),u.addEventListener("load",g),u.addEventListener("error",O)});Ur(d)}}const M={tag:e,type:e,props:{...f,ref:P},ref:P};return M.p=r,u&&(M.e=u),Ir(M,i)},Vr=e=>{const t=Mr();return(t&&Z(t))?.endsWith("svg")?{tag:"title",props:e,type:"title",ref:e.ref}:ce("title",e,void 0,!1,!1)},Xr=e=>!e||["src","async"].some(t=>!e[t])?{tag:"script",props:e,type:"script",ref:e.ref}:ce("script",e,1,!1,!0),Jr=e=>!e||!["href","precedence"].every(t=>t in e)?{tag:"style",props:e,type:"style",ref:e.ref}:(e["data-href"]=e.href,delete e.href,ce("style",e,2,!0,!0)),Zr=e=>!e||["onLoad","onError"].some(t=>t in e)||e.rel==="stylesheet"&&(!("precedence"in e)||"disabled"in e)?{tag:"link",props:e,type:"link",ref:e.ref}:ce("link",e,1,"precedence"in e,!0),Yr=e=>ce("meta",e,void 0,!1,!1),It=Symbol(),Qr=e=>{const{action:t,...r}=e;typeof t!="function"&&(r.action=t);const[n,s]=Wr([null,!1]),i=Ge(async a=>{const f=a.isTrusted?t:a.detail[It];if(typeof f!="function")return;a.preventDefault();const u=new FormData(a.target);s([u,!0]);const h=f(u);h instanceof Promise&&(Gr(h),await h),s([null,!0])},[]),o=Ve(e.ref,a=>(a.addEventListener("submit",i),()=>{a.removeEventListener("submit",i)})),[l,c]=n;return n[1]=!1,{tag:zr,props:{value:{pending:l!==null,data:l,method:l?"post":null,action:l?t:null},children:{tag:"form",props:{...r,ref:o},type:"form",ref:o}},f:c}},Ht=(e,{formAction:t,...r})=>{if(typeof t=="function"){const n=Ge(s=>{s.preventDefault(),s.currentTarget.form.dispatchEvent(new CustomEvent("submit",{detail:{[It]:t}}))},[]);r.ref=Ve(r.ref,s=>(s.addEventListener("click",n),()=>{s.removeEventListener("click",n)}))}return{tag:e,props:r,type:e,ref:r.ref}},en=e=>Ht("input",e),tn=e=>Ht("button",e);Object.assign(De,{title:Vr,script:Xr,style:Jr,link:Zr,meta:Yr,form:Qr,input:en,button:tn});We(null);new TextEncoder;var rn=We(null),nn=(e,t,r,n)=>(s,i)=>{const o="<!DOCTYPE html>",l=r?st(a=>r(a,e),{Layout:t,...i},s):s,c=vr`${L(o)}${st(rn.Provider,{value:e},l)}`;return e.html(c)},sn=(e,t)=>function(n,s){const i=n.getLayout()??ze;return e&&n.setLayout(o=>e({...o,Layout:i},n)),n.setRenderer(nn(n,i,e)),s()};const on=sn(({children:e})=>C("html",{lang:"en",children:[C("head",{children:[C("meta",{charSet:"utf-8"}),C("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),C("title",{children:"HonoX Solid Form Sample"}),C("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"}),C(bs,{src:"/app/client.tsx"})]}),C("body",{children:C("main",{class:"container",children:e})})]})),an=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"}));var vt=(e,t,r)=>(n,s)=>{let i=-1;return o(0);async function o(l){if(l<=i)throw new Error("next() called multiple times");i=l;let c,a=!1,f;if(e[l]?(f=e[l][0][0],n.req.routeIndex=l):f=l===e.length&&s||void 0,f)try{c=await f(n,()=>o(l+1))}catch(u){if(u instanceof Error&&t)n.error=u,c=await t(u,n),a=!0;else throw u}else n.finalized===!1&&r&&(c=await r(n));return c&&(n.finalized===!1||a)&&(n.res=c),n}},ln=Symbol(),cn=async(e,t=Object.create(null))=>{const{all:r=!1,dot:n=!1}=t,i=(e instanceof Kt?e.raw.headers:e.headers).get("Content-Type");return i?.startsWith("multipart/form-data")||i?.startsWith("application/x-www-form-urlencoded")?un(e,{all:r,dot:n}):{}};async function un(e,t){const r=await e.formData();return r?fn(r,t):{}}function fn(e,t){const r=Object.create(null);return e.forEach((n,s)=>{t.all||s.endsWith("[]")?hn(r,s,n):r[s]=n}),t.dot&&Object.entries(r).forEach(([n,s])=>{n.includes(".")&&(dn(r,n,s),delete r[n])}),r}var hn=(e,t,r)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:t.endsWith("[]")?e[t]=[r]:e[t]=r},dn=(e,t,r)=>{let n=e;const s=t.split(".");s.forEach((i,o)=>{o===s.length-1?n[i]=r:((!n[i]||typeof n[i]!="object"||Array.isArray(n[i])||n[i]instanceof File)&&(n[i]=Object.create(null)),n=n[i])})},Ft=e=>{const t=e.split("/");return t[0]===""&&t.shift(),t},pn=e=>{const{groups:t,path:r}=gn(e),n=Ft(r);return vn(n,t)},gn=e=>{const t=[];return e=e.replace(/\{[^}]+\}/g,(r,n)=>{const s=`@${n}`;return t.push([s,r]),s}),{groups:t,path:e}},vn=(e,t)=>{for(let r=t.length-1;r>=0;r--){const[n]=t[r];for(let s=e.length-1;s>=0;s--)if(e[s].includes(n)){e[s]=e[s].replace(n,t[r][1]);break}}return e},fe={},yn=(e,t)=>{if(e==="*")return"*";const r=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(r){const n=`${e}#${t}`;return fe[n]||(r[2]?fe[n]=t&&t[0]!==":"&&t[0]!=="*"?[n,r[1],new RegExp(`^${r[2]}(?=/${t})`)]:[e,r[1],new RegExp(`^${r[2]}$`)]:fe[n]=[e,r[1],!0]),fe[n]}return null},Xe=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,r=>{try{return t(r)}catch{return r}})}},mn=e=>Xe(e,decodeURI),qt=e=>{const t=e.url,r=t.indexOf("/",t.indexOf(":")+4);let n=r;for(;n<t.length;n++){const s=t.charCodeAt(n);if(s===37){const i=t.indexOf("?",n),o=t.indexOf("#",n),l=i===-1?o===-1?void 0:o:o===-1?i:Math.min(i,o),c=t.slice(r,l);return mn(c.includes("%25")?c.replace(/%25/g,"%2525"):c)}else if(s===63||s===35)break}return t.slice(r,n)},bn=e=>{const t=qt(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t},K=(e,t,...r)=>(r.length&&(t=K(t,...r)),`${e?.[0]==="/"?"":"/"}${e}${t==="/"?"":`${e?.at(-1)==="/"?"":"/"}${t?.[0]==="/"?t.slice(1):t}`}`),Bt=e=>{if(e.charCodeAt(e.length-1)!==63||!e.includes(":"))return null;const t=e.split("/"),r=[];let n="";return t.forEach(s=>{if(s!==""&&!/\:/.test(s))n+="/"+s;else if(/\:/.test(s))if(/\?/.test(s)){r.length===0&&n===""?r.push("/"):r.push(n);const i=s.replace("?","");n+="/"+i,r.push(n)}else n+="/"+s}),r.filter((s,i,o)=>o.indexOf(s)===i)},Pe=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?Xe(e,Ut):e):e,Wt=(e,t,r)=>{let n;if(!r&&t&&!/[%+]/.test(t)){let o=e.indexOf("?",8);if(o===-1)return;for(e.startsWith(t,o+1)||(o=e.indexOf(`&${t}`,o+1));o!==-1;){const l=e.charCodeAt(o+t.length+1);if(l===61){const c=o+t.length+2,a=e.indexOf("&",c);return Pe(e.slice(c,a===-1?void 0:a))}else if(l==38||isNaN(l))return"";o=e.indexOf(`&${t}`,o+1)}if(n=/[%+]/.test(e),!n)return}const s={};n??=/[%+]/.test(e);let i=e.indexOf("?",8);for(;i!==-1;){const o=e.indexOf("&",i+1);let l=e.indexOf("=",i);l>o&&o!==-1&&(l=-1);let c=e.slice(i+1,l===-1?o===-1?void 0:o:l);if(n&&(c=Pe(c)),i=o,c==="")continue;let a;l===-1?a="":(a=e.slice(l+1,o===-1?void 0:o),n&&(a=Pe(a))),r?(s[c]&&Array.isArray(s[c])||(s[c]=[]),s[c].push(a)):s[c]??=a}return t?s[t]:s},En=Wt,wn=(e,t)=>Wt(e,t,!0),Ut=decodeURIComponent,yt=e=>Xe(e,Ut),Kt=class{raw;#e;#t;routeIndex=0;path;bodyCache={};constructor(e,t="/",r=[[]]){this.raw=e,this.path=t,this.#t=r,this.#e={}}param(e){return e?this.#r(e):this.#i()}#r(e){const t=this.#t[0][this.routeIndex][1][e],r=this.#s(t);return r&&/\%/.test(r)?yt(r):r}#i(){const e={},t=Object.keys(this.#t[0][this.routeIndex][1]);for(const r of t){const n=this.#s(this.#t[0][this.routeIndex][1][r]);n!==void 0&&(e[r]=/\%/.test(n)?yt(n):n)}return e}#s(e){return this.#t[1]?this.#t[1][e]:e}query(e){return En(this.url,e)}queries(e){return wn(this.url,e)}header(e){if(e)return this.raw.headers.get(e)??void 0;const t={};return this.raw.headers.forEach((r,n)=>{t[n]=r}),t}async parseBody(e){return this.bodyCache.parsedBody??=await cn(this,e)}#n=e=>{const{bodyCache:t,raw:r}=this,n=t[e];if(n)return n;const s=Object.keys(t)[0];return s?t[s].then(i=>(s==="json"&&(i=JSON.stringify(i)),new Response(i)[e]())):t[e]=r[e]()};json(){return this.#n("text").then(e=>JSON.parse(e))}text(){return this.#n("text")}arrayBuffer(){return this.#n("arrayBuffer")}blob(){return this.#n("blob")}formData(){return this.#n("formData")}addValidatedData(e,t){this.#e[e]=t}valid(e){return this.#e[e]}get url(){return this.raw.url}get method(){return this.raw.method}get[ln](){return this.#t}get matchedRoutes(){return this.#t[0].map(([[,e]])=>e)}get routePath(){return this.#t[0].map(([[,e]])=>e)[this.routeIndex].path}},Rn="text/plain; charset=UTF-8",ke=(e,t)=>({"Content-Type":e,...t}),Sn=class{#e;#t;env={};#r;finalized=!1;error;#i;#s;#n;#u;#l;#c;#a;#f;#h;constructor(e,t){this.#e=e,t&&(this.#s=t.executionCtx,this.env=t.env,this.#c=t.notFoundHandler,this.#h=t.path,this.#f=t.matchResult)}get req(){return this.#t??=new Kt(this.#e,this.#h,this.#f),this.#t}get event(){if(this.#s&&"respondWith"in this.#s)return this.#s;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#s)return this.#s;throw Error("This context has no ExecutionContext")}get res(){return this.#n||=new Response(null,{headers:this.#a??=new Headers})}set res(e){if(this.#n&&e){e=new Response(e.body,e);for(const[t,r]of this.#n.headers.entries())if(t!=="content-type")if(t==="set-cookie"){const n=this.#n.headers.getSetCookie();e.headers.delete("set-cookie");for(const s of n)e.headers.append("set-cookie",s)}else e.headers.set(t,r)}this.#n=e,this.finalized=!0}render=(...e)=>(this.#l??=t=>this.html(t),this.#l(...e));setLayout=e=>this.#u=e;getLayout=()=>this.#u;setRenderer=e=>{this.#l=e};header=(e,t,r)=>{this.finalized&&(this.#n=new Response(this.#n.body,this.#n));const n=this.#n?this.#n.headers:this.#a??=new Headers;t===void 0?n.delete(e):r?.append?n.append(e,t):n.set(e,t)};status=e=>{this.#i=e};set=(e,t)=>{this.#r??=new Map,this.#r.set(e,t)};get=e=>this.#r?this.#r.get(e):void 0;get var(){return this.#r?Object.fromEntries(this.#r):{}}#o(e,t,r){const n=this.#n?new Headers(this.#n.headers):this.#a??new Headers;if(typeof t=="object"&&"headers"in t){const i=t.headers instanceof Headers?t.headers:new Headers(t.headers);for(const[o,l]of i)o.toLowerCase()==="set-cookie"?n.append(o,l):n.set(o,l)}if(r)for(const[i,o]of Object.entries(r))if(typeof o=="string")n.set(i,o);else{n.delete(i);for(const l of o)n.append(i,l)}const s=typeof t=="number"?t:t?.status??this.#i;return new Response(e,{status:s,headers:n})}newResponse=(...e)=>this.#o(...e);body=(e,t,r)=>this.#o(e,t,r);text=(e,t,r)=>!this.#a&&!this.#i&&!t&&!r&&!this.finalized?new Response(e):this.#o(e,t,ke(Rn,r));json=(e,t,r)=>this.#o(JSON.stringify(e),t,ke("application/json",r));html=(e,t,r)=>{const n=s=>this.#o(s,t,ke("text/html; charset=UTF-8",r));return typeof e=="object"?Ot(e,wt.Stringify,!1,{}).then(n):n(e)};redirect=(e,t)=>{const r=String(e);return this.header("Location",/[^\x00-\xFF]/.test(r)?encodeURI(r):r),this.newResponse(null,t??302)};notFound=()=>(this.#c??=()=>new Response,this.#c(this))},k="ALL",On="all",xn=["get","post","put","delete","options","patch"],zt="Can not add a route since the matcher is already built.",Gt=class extends Error{},An=e=>e.text("404 Not Found",404),mt=(e,t)=>{if("getResponse"in e){const r=e.getResponse();return t.newResponse(r.body,r)}return console.error(e),t.text("Internal Server Error",500)},Pn=class Vt{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#e="/";routes=[];constructor(t={}){[...xn,On].forEach(i=>{this[i]=(o,...l)=>(typeof o=="string"?this.#e=o:this.#i(i,this.#e,o),l.forEach(c=>{this.#i(i,this.#e,c)}),this)}),this.on=(i,o,...l)=>{for(const c of[o].flat()){this.#e=c;for(const a of[i].flat())l.map(f=>{this.#i(a.toUpperCase(),this.#e,f)})}return this},this.use=(i,...o)=>(typeof i=="string"?this.#e=i:(this.#e="*",o.unshift(i)),o.forEach(l=>{this.#i(k,this.#e,l)}),this);const{strict:n,...s}=t;Object.assign(this,s),this.getPath=n??!0?t.getPath??qt:bn}#t(){const t=new Vt({router:this.router,getPath:this.getPath});return t.errorHandler=this.errorHandler,t.#r=this.#r,t.routes=this.routes,t}#r=An;errorHandler=mt;route(t,r){const n=this.basePath(t);return r.routes.map(s=>{let i;r.errorHandler===mt?i=s.handler:(i=async(o,l)=>(await vt([],r.errorHandler)(o,()=>s.handler(o,l))).res,i[$e]=s.handler),n.#i(s.method,s.path,i)}),this}basePath(t){const r=this.#t();return r._basePath=K(this._basePath,t),r}onError=t=>(this.errorHandler=t,this);notFound=t=>(this.#r=t,this);mount(t,r,n){let s,i;n&&(typeof n=="function"?i=n:(i=n.optionHandler,n.replaceRequest===!1?s=c=>c:s=n.replaceRequest));const o=i?c=>{const a=i(c);return Array.isArray(a)?a:[a]}:c=>{let a;try{a=c.executionCtx}catch{}return[c.env,a]};s||=(()=>{const c=K(this._basePath,t),a=c==="/"?0:c.length;return f=>{const u=new URL(f.url);return u.pathname=u.pathname.slice(a)||"/",new Request(u,f)}})();const l=async(c,a)=>{const f=await r(s(c.req.raw),...o(c));if(f)return f;await a()};return this.#i(k,K(t,"*"),l),this}#i(t,r,n){t=t.toUpperCase(),r=K(this._basePath,r);const s={basePath:this._basePath,path:r,method:t,handler:n};this.router.add(t,r,[n,s]),this.routes.push(s)}#s(t,r){if(t instanceof Error)return this.errorHandler(t,r);throw t}#n(t,r,n,s){if(s==="HEAD")return(async()=>new Response(null,await this.#n(t,r,n,"GET")))();const i=this.getPath(t,{env:n}),o=this.router.match(s,i),l=new Sn(t,{path:i,matchResult:o,env:n,executionCtx:r,notFoundHandler:this.#r});if(o[0].length===1){let a;try{a=o[0][0][0][0](l,async()=>{l.res=await this.#r(l)})}catch(f){return this.#s(f,l)}return a instanceof Promise?a.then(f=>f||(l.finalized?l.res:this.#r(l))).catch(f=>this.#s(f,l)):a??this.#r(l)}const c=vt(o[0],this.errorHandler,this.#r);return(async()=>{try{const a=await c(l);if(!a.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return a.res}catch(a){return this.#s(a,l)}})()}fetch=(t,...r)=>this.#n(t,r[1],r[0],t.method);request=(t,r,n,s)=>t instanceof Request?this.fetch(r?new Request(t,r):t,n,s):(t=t.toString(),this.fetch(new Request(/^https?:\/\//.test(t)?t:`http://localhost${K("/",t)}`,r),n,s));fire=()=>{addEventListener("fetch",t=>{t.respondWith(this.#n(t.request,t,void 0,t.request.method))})}},Xt=[];function kn(e,t){const r=this.buildAllMatchers(),n=((s,i)=>{const o=r[s]||r[k],l=o[2][i];if(l)return l;const c=i.match(o[0]);if(!c)return[[],Xt];const a=c.indexOf("",1);return[o[1][a],c]});return this.match=n,n(e,t)}var we="[^/]+",ee=".*",te="(?:|/.*)",z=Symbol(),jn=new Set(".\\+*[^]$()");function Cn(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===ee||e===te?1:t===ee||t===te?-1:e===we?1:t===we?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var _n=class He{#e;#t;#r=Object.create(null);insert(t,r,n,s,i){if(t.length===0){if(this.#e!==void 0)throw z;if(i)return;this.#e=r;return}const[o,...l]=t,c=o==="*"?l.length===0?["","",ee]:["","",we]:o==="/*"?["","",te]:o.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let a;if(c){const f=c[1];let u=c[2]||we;if(f&&c[2]&&(u===".*"||(u=u.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(u))))throw z;if(a=this.#r[u],!a){if(Object.keys(this.#r).some(h=>h!==ee&&h!==te))throw z;if(i)return;a=this.#r[u]=new He,f!==""&&(a.#t=s.varIndex++)}!i&&f!==""&&n.push([f,a.#t])}else if(a=this.#r[o],!a){if(Object.keys(this.#r).some(f=>f.length>1&&f!==ee&&f!==te))throw z;if(i)return;a=this.#r[o]=new He}a.insert(l,r,n,s,i)}buildRegExpStr(){const r=Object.keys(this.#r).sort(Cn).map(n=>{const s=this.#r[n];return(typeof s.#t=="number"?`(${n})@${s.#t}`:jn.has(n)?`\\${n}`:n)+s.buildRegExpStr()});return typeof this.#e=="number"&&r.unshift(`#${this.#e}`),r.length===0?"":r.length===1?r[0]:"(?:"+r.join("|")+")"}},Mn=class{#e={varIndex:0};#t=new _n;insert(e,t,r){const n=[],s=[];for(let o=0;;){let l=!1;if(e=e.replace(/\{[^}]+\}/g,c=>{const a=`@\\${o}`;return s[o]=[a,c],o++,l=!0,a}),!l)break}const i=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let o=s.length-1;o>=0;o--){const[l]=s[o];for(let c=i.length-1;c>=0;c--)if(i[c].indexOf(l)!==-1){i[c]=i[c].replace(l,s[o][1]);break}}return this.#t.insert(i,t,n,this.#e,r),n}buildRegExp(){let e=this.#t.buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0;const r=[],n=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(s,i,o)=>i!==void 0?(r[++t]=Number(i),"$()"):(o!==void 0&&(n[Number(o)]=++t),"")),[new RegExp(`^${e}`),r,n]}},Tn=[/^$/,[],Object.create(null)],Jt=Object.create(null);function Zt(e){return Jt[e]??=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,r)=>r?`\\${r}`:"(?:|/.*)")}$`)}function $n(){Jt=Object.create(null)}function Nn(e){const t=new Mn,r=[];if(e.length===0)return Tn;const n=e.map(a=>[!/\*|\/:/.test(a[0]),...a]).sort(([a,f],[u,h])=>a?1:u?-1:f.length-h.length),s=Object.create(null);for(let a=0,f=-1,u=n.length;a<u;a++){const[h,p,E]=n[a];h?s[p]=[E.map(([P])=>[P,Object.create(null)]),Xt]:f++;let v;try{v=t.insert(p,f,h)}catch(P){throw P===z?new Gt(p):P}h||(r[f]=E.map(([P,M])=>{const x=Object.create(null);for(M-=1;M>=0;M--){const[S,d]=v[M];x[S]=d}return[P,x]}))}const[i,o,l]=t.buildRegExp();for(let a=0,f=r.length;a<f;a++)for(let u=0,h=r[a].length;u<h;u++){const p=r[a][u]?.[1];if(!p)continue;const E=Object.keys(p);for(let v=0,P=E.length;v<P;v++)p[E[v]]=l[p[E[v]]]}const c=[];for(const a in o)c[a]=r[o[a]];return[i,c,s]}function U(e,t){if(e){for(const r of Object.keys(e).sort((n,s)=>s.length-n.length))if(Zt(r).test(t))return[...e[r]]}}var Dn=class{name="RegExpRouter";#e;#t;constructor(){this.#e={[k]:Object.create(null)},this.#t={[k]:Object.create(null)}}add(e,t,r){const n=this.#e,s=this.#t;if(!n||!s)throw new Error(zt);n[e]||[n,s].forEach(l=>{l[e]=Object.create(null),Object.keys(l[k]).forEach(c=>{l[e][c]=[...l[k][c]]})}),t==="/*"&&(t="*");const i=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){const l=Zt(t);e===k?Object.keys(n).forEach(c=>{n[c][t]||=U(n[c],t)||U(n[k],t)||[]}):n[e][t]||=U(n[e],t)||U(n[k],t)||[],Object.keys(n).forEach(c=>{(e===k||e===c)&&Object.keys(n[c]).forEach(a=>{l.test(a)&&n[c][a].push([r,i])})}),Object.keys(s).forEach(c=>{(e===k||e===c)&&Object.keys(s[c]).forEach(a=>l.test(a)&&s[c][a].push([r,i]))});return}const o=Bt(t)||[t];for(let l=0,c=o.length;l<c;l++){const a=o[l];Object.keys(s).forEach(f=>{(e===k||e===f)&&(s[f][a]||=[...U(n[f],a)||U(n[k],a)||[]],s[f][a].push([r,i-c+l+1]))})}}match=kn;buildAllMatchers(){const e=Object.create(null);return Object.keys(this.#t).concat(Object.keys(this.#e)).forEach(t=>{e[t]||=this.#r(t)}),this.#e=this.#t=void 0,$n(),e}#r(e){const t=[];let r=e===k;return[this.#e,this.#t].forEach(n=>{const s=n[e]?Object.keys(n[e]).map(i=>[i,n[e][i]]):[];s.length!==0?(r||=!0,t.push(...s)):e!==k&&t.push(...Object.keys(n[k]).map(i=>[i,n[k][i]]))}),r?Nn(t):null}},Ln=class{name="SmartRouter";#e=[];#t=[];constructor(e){this.#e=e.routers}add(e,t,r){if(!this.#t)throw new Error(zt);this.#t.push([e,t,r])}match(e,t){if(!this.#t)throw new Error("Fatal error");const r=this.#e,n=this.#t,s=r.length;let i=0,o;for(;i<s;i++){const l=r[i];try{for(let c=0,a=n.length;c<a;c++)l.add(...n[c]);o=l.match(e,t)}catch(c){if(c instanceof Gt)continue;throw c}this.match=l.match.bind(l),this.#e=[l],this.#t=void 0;break}if(i===s)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,o}get activeRouter(){if(this.#t||this.#e.length!==1)throw new Error("No active router has been determined yet.");return this.#e[0]}},Y=Object.create(null),In=class Yt{#e;#t;#r;#i=0;#s=Y;constructor(t,r,n){if(this.#t=n||Object.create(null),this.#e=[],t&&r){const s=Object.create(null);s[t]={handler:r,possibleKeys:[],score:0},this.#e=[s]}this.#r=[]}insert(t,r,n){this.#i=++this.#i;let s=this;const i=pn(r),o=[];for(let l=0,c=i.length;l<c;l++){const a=i[l],f=i[l+1],u=yn(a,f),h=Array.isArray(u)?u[0]:a;if(h in s.#t){s=s.#t[h],u&&o.push(u[1]);continue}s.#t[h]=new Yt,u&&(s.#r.push(u),o.push(u[1])),s=s.#t[h]}return s.#e.push({[t]:{handler:n,possibleKeys:o.filter((l,c,a)=>a.indexOf(l)===c),score:this.#i}}),s}#n(t,r,n,s){const i=[];for(let o=0,l=t.#e.length;o<l;o++){const c=t.#e[o],a=c[r]||c[k],f={};if(a!==void 0&&(a.params=Object.create(null),i.push(a),n!==Y||s&&s!==Y))for(let u=0,h=a.possibleKeys.length;u<h;u++){const p=a.possibleKeys[u],E=f[a.score];a.params[p]=s?.[p]&&!E?s[p]:n[p]??s?.[p],f[a.score]=!0}}return i}search(t,r){const n=[];this.#s=Y;let i=[this];const o=Ft(r),l=[];for(let c=0,a=o.length;c<a;c++){const f=o[c],u=c===a-1,h=[];for(let p=0,E=i.length;p<E;p++){const v=i[p],P=v.#t[f];P&&(P.#s=v.#s,u?(P.#t["*"]&&n.push(...this.#n(P.#t["*"],t,v.#s)),n.push(...this.#n(P,t,v.#s))):h.push(P));for(let M=0,x=v.#r.length;M<x;M++){const S=v.#r[M],d=v.#s===Y?{}:{...v.#s};if(S==="*"){const D=v.#t["*"];D&&(n.push(...this.#n(D,t,v.#s)),D.#s=d,h.push(D));continue}const[g,O,y]=S;if(!f&&!(y instanceof RegExp))continue;const $=v.#t[g],I=o.slice(c).join("/");if(y instanceof RegExp){const D=y.exec(I);if(D){if(d[O]=D[0],n.push(...this.#n($,t,v.#s,d)),Object.keys($.#t).length){$.#s=d;const ue=D[0].match(/\//)?.length??0;(l[ue]||=[]).push($)}continue}}(y===!0||y.test(f))&&(d[O]=f,u?(n.push(...this.#n($,t,d,v.#s)),$.#t["*"]&&n.push(...this.#n($.#t["*"],t,d,v.#s))):($.#s=d,h.push($)))}}i=h.concat(l.shift()??[])}return n.length>1&&n.sort((c,a)=>c.score-a.score),[n.map(({handler:c,params:a})=>[c,a])]}},Hn=class{name="TrieRouter";#e;constructor(){this.#e=new In}add(e,t,r){const n=Bt(t);if(n){for(let s=0,i=n.length;s<i;s++)this.#e.insert(e,n[s],r);return}this.#e.insert(e,t,r)}match(e,t){return this.#e.search(e,t)}},G=class extends Pn{constructor(e={}){super(e),this.router=e.router??new Ln({routers:[new Dn,new Hn]})}},Fn=class{initApp;#e;constructor(e){this.initApp=e?.initApp,this.#e=e?.defaultAppOptions}createApp=e=>{const t=new G(e&&this.#e?{...this.#e,...e}:e??this.#e);return this.initApp&&this.initApp(t),t};createMiddleware=e=>e;createHandlers=(...e)=>e.filter(t=>t!==void 0)},qn=e=>new Fn(e),je=e=>e;const Bn=qn(),Qt=Bn.createHandlers;let Ce;function er(e){return{lang:e?.lang??Ce?.lang,message:e?.message,abortEarly:e?.abortEarly??Ce?.abortEarly,abortPipeEarly:e?.abortPipeEarly??Ce?.abortPipeEarly}}let Wn;function Un(e){return Wn?.get(e)}let Kn;function zn(e){return Kn?.get(e)}let Gn;function Vn(e,t){return Gn?.get(e)?.get(t)}function Xn(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function J(e,t,r,n,s){const i=s&&"input"in s?s.input:r.value,o=s?.expected??e.expects??null,l=s?.received??Xn(i),c={kind:e.kind,type:e.type,input:i,expected:o,received:l,message:`Invalid ${t}: ${o?`Expected ${o} but r`:"R"}eceived ${l}`,requirement:e.requirement,path:s?.path,issues:s?.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},a=e.kind==="schema",f=s?.message??e.message??Vn(e.reference,c.lang)??(a?zn(c.lang):null)??n.message??Un(c.lang);f!==void 0&&(c.message=typeof f=="function"?f(c):f),a&&(r.typed=!1),r.issues?r.issues.push(c):r.issues=[c]}function Je(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},er())}}}const Jn=/^[\w+-]+(?:\.[\w+-]+)*@[\da-z]+(?:[.-][\da-z]+)*\.[a-z]{2,}$/iu;function tr(e){return{kind:"validation",type:"email",reference:tr,expects:null,async:!1,requirement:Jn,message:e,"~run"(t,r){return t.typed&&!this.requirement.test(t.value)&&J(this,"email",t,r),t}}}function Fe(e,t){return{kind:"validation",type:"max_length",reference:Fe,async:!1,expects:`<=${e}`,requirement:e,message:t,"~run"(r,n){return r.typed&&r.value.length>this.requirement&&J(this,"length",r,n,{received:`${r.value.length}`}),r}}}function qe(e,t){return{kind:"validation",type:"min_length",reference:qe,async:!1,expects:`>=${e}`,requirement:e,message:t,"~run"(r,n){return r.typed&&r.value.length<this.requirement&&J(this,"length",r,n,{received:`${r.value.length}`}),r}}}function ye(){return{kind:"transformation",type:"trim",reference:ye,async:!1,"~run"(e){return e.value=e.value.trim(),e}}}function Zn(e,t,r){return typeof e.fallback=="function"?e.fallback(t,r):e.fallback}function Yn(e,t,r){return typeof e.default=="function"?e.default(t,r):e.default}function rr(e,t){return{kind:"schema",type:"object",reference:rr,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return Je(this)},"~run"(r,n){const s=r.value;if(s&&typeof s=="object"){r.typed=!0,r.value={};for(const i in this.entries){const o=this.entries[i];if(i in s||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){const l=i in s?s[i]:Yn(o),c=o["~run"]({value:l},n);if(c.issues){const a={type:"object",origin:"value",input:s,key:i,value:l};for(const f of c.issues)f.path?f.path.unshift(a):f.path=[a],r.issues?.push(f);if(r.issues||(r.issues=c.issues),n.abortEarly){r.typed=!1;break}}c.typed||(r.typed=!1),r.value[i]=c.value}else if(o.fallback!==void 0)r.value[i]=Zn(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(J(this,"key",r,n,{input:void 0,expected:`"${i}"`,path:[{type:"object",origin:"key",input:s,key:i,value:s[i]}]}),n.abortEarly))break}}else J(this,"type",r,n);return r}}}function me(e){return{kind:"schema",type:"string",reference:me,expects:"string",async:!1,message:e,get"~standard"(){return Je(this)},"~run"(t,r){return typeof t.value=="string"?t.typed=!0:J(this,"type",t,r),t}}}function _e(...e){return{...e[0],pipe:e,get"~standard"(){return Je(this)},"~run"(t,r){for(const n of e)if(n.kind!=="metadata"){if(t.issues&&(n.kind==="schema"||n.kind==="transformation")){t.typed=!1;break}(!t.issues||!r.abortEarly&&!r.abortPipeEarly)&&(t=n["~run"](t,r))}return t}}}function Qn(e,t,r){const n=e["~run"]({value:t},er(r));return{typed:n.typed,success:!n.issues,output:n.value,issues:n.issues}}const es=rr({name:_e(me(),ye(),qe(1,"Name is required"),Fe(50,"Name must be 50 characters or fewer")),email:_e(me(),ye(),tr("Email must be a valid address")),message:_e(me(),ye(),qe(1,"Message is required"),Fe(500,"Message must be 500 characters or fewer"))}),ts=e=>e.map(t=>({path:t.path?.map(n=>typeof n.key=="string"?n.key:String(n.key)).join(".")??"root",message:t.message})),rs=Qt(async e=>{if(!(e.req.header("content-type")??"").includes("application/json"))return e.json({ok:!1,errors:[{path:"root",message:"Content-Type must be application/json"}]},400);let r;try{r=await e.req.json()}catch{return e.json({ok:!1,errors:[{path:"root",message:"Invalid JSON body"}]},400)}const n=Qn(es,r);return n.success?e.json({ok:!0,data:n.output}):e.json({ok:!1,errors:ts(n.issues)},400)}),ns=Object.freeze(Object.defineProperty({__proto__:null,POST:rs},Symbol.toStringTag,{value:"Module"})),ss=Qt(e=>e.render(C("section",{children:[C("h1",{children:"Contact Form Sample"}),C("p",{children:"HonoX + SolidJS + PicoCSS + Valibot"}),C("div",{id:"app"})]}))),is=Object.freeze(Object.defineProperty({__proto__:null,default:ss},Symbol.toStringTag,{value:"Module"})),B="__importing_islands",nr=new ur,Me=e=>(e=e.replace(/\.tsx?$/g,"").replace(/\.mdx?$/g,"").replace(/^\/?index$/,"/").replace(/\/index$/,"").replace(/\[\.{3}(.+?)\]/,":$1{.+}").replace(/\((.+?)\)/g,"").replace(/\[(.+?)\]/g,":$1").replace(/\/\/+/g,"/"),e.startsWith("/")?e:"/"+e),Te=e=>{const t={};for(const[r,n]of Object.entries(e)){const s=r.split("/"),i=s.pop(),o=s.join("/");t[o]||(t[o]={}),i&&(t[o][i]=n)}for(const[r,n]of Object.entries(t)){const s=Object.entries(n).sort(([i],[o])=>i[0]==="["&&o[0]!=="["?1:i[0]!=="["&&o[0]==="["?-1:i.localeCompare(o));t[r]=Object.fromEntries(s)}return t},os=e=>Object.keys(e).sort((r,n)=>{const s=r.split("/").length,i=n.split("/").length;return s-i||n.localeCompare(r)}).map(r=>({[r]:e[r]})),as=e=>{const t={};for(const n of Object.keys(e)){const s=n.split("/");s.pop();const i=s.join("/");t[i]||(t[i]=[]),t[i].includes(n)||t[i].push(n)}const r=Object.keys(t).sort((n,s)=>s.length-n.length);for(const n of r)for(const s of r)if(s.startsWith(n)&&s!==n){const i=new Set([...t[s],...t[n]]);t[s]=[...i]}return t},sr="_404.tsx",ls="_error.tsx",cs=["GET","POST","PUT","DELETE","OPTIONS","PATCH"],us=e=>{const t=e.root,r=new RegExp(`^${t}`),n=d=>Me(d.replace(r,"")),s=new G,i=new Map,o=new WeakSet,l=new WeakMap,c=new WeakMap;s.use(async function(g,O){await nr.run(g,()=>O())});const a=e.NOT_FOUND,f=Te(a),u=e.ERROR,h=Te(u),p=e.RENDERER,E=as(p),v=e.MIDDLEWARE,P=e.ROUTES,M=os(Te(P)),x=(d,g)=>{let O=g[d]??[];const y=I=>(O=g[I.join("/")],O||(I.pop(),I.length&&y(I)),O??[]),$=d.split("/");return O=y($),O.sort((I,D)=>I.split("/").length-D.split("/").length),O},S={};for(const d of M)for(const[g,O]of Object.entries(d)){const y=new G;let $=!1;const I=fs(g,f);I&&y.use(async(m,w)=>{if(await w(),m.res.status===404&&!o.has(m.res)){const _=await I(m),R=new Response(_.body,{status:404,headers:_.headers});m.res=R,o.add(m.res)}});const D=m=>m.replaceAll("[","\\[").replaceAll("]","\\]").replaceAll("(","\\(").replaceAll(")","\\)"),ue=m=>Object.keys(v).find(w=>new RegExp(D(m)+"/_middleware.tsx?").test(w)),Ye=(m,w)=>{const _=w.split("/"),R=[];for(let b=_.length-1;b>0;b--)R.push(_.slice(0,b).join("/"));return R.some(b=>i.get(b)?.has(m))},Qe=m=>{const _=!g.replace(r,"").includes("/"),R=!Object.keys(O).some(b=>b.includes("/"));Object.keys(O).length>0&&_&&R&&(y.use("/",...m),Object.keys(O).forEach(b=>{const j=Me(b);j!=="/"&&!j.includes("[")&&!j.includes("*")&&y.use(j,...m)}))};x(g,E).map(m=>{const w=p[m];w[B]&&($=!0);const R=w.default;if(R){l.has(R)||l.set(R,new WeakSet);const b=l.get(R),j=je(async(T,N)=>b.has(T.req.raw)?N():(b.add(T.req.raw),R(T,N)));y.use("*",j),Qe([j])}});let W=ue(g);if(!W){const m=g.split("/");for(let w=m.length-1;w>=0;w--){const _=m.slice(0,w).join("/");if(!_.includes(t))break;const R=ue(_);if(R&&!Ye(R,g)){W=R;break}}}if(W){const m=v[W],w=W.replace("/_middleware.tsx","").replace("/_middleware.ts",""),_=w===g||g.startsWith(w+"/");if(m.default&&_){const R=m.default.map(b=>{c.has(b)||c.set(b,new WeakSet);const j=c.get(b);return je(async(T,N)=>j.has(T.req.raw)?N():(j.add(T.req.raw),b(T,N)))});y.use("*",...R),Qe(R),i.has(g)||i.set(g,new Set),i.get(g)?.add(W)}}for(const[m,w]of Object.entries(O)){const _=w[B],R=je(async function(N,cr){N.set(B,_?!0:$),await cr()}),b=w.default,j=Me(m);b&&"fetch"in b&&(y.use(R),y.route(j,b));for(const T of cs){const N=w[T];N&&(y.on(T,j,R),y.on(T,j,...N))}b&&Array.isArray(b)&&(y.get(j,R),y.get(j,...b)),typeof b=="function"&&(y.get(j,R),y.get(j,async T=>{const N=await b(T);return N instanceof Response?N:T.render(N,w)}))}const et=ds(g,h);et&&(S[g]=et);for(const[m,w]of Object.entries(S))new RegExp(`^${m}`).test(g)&&w&&y.onError(w);let lr=n(g);s.route(lr,y)}for(const d of M.reverse()){const g=Object.entries(d)[0][0],O=new G;hs(O,g,f,o);const y=n(g);s.route(y,O)}return s};function fs(e,t){for(const[r,n]of Object.entries(t))if(e===r){const s=n[sr];if(s)return s.default}}function hs(e,t,r,n){for(const[s,i]of Object.entries(r))if(t===s){const o=i[sr];if(o){const l=o.default;o[B]&&e.use("*",(a,f)=>(a.set(B,!0),f())),e.get("*",async(a,f)=>{await f(),n.has(a.res)&&(a.status(404),n.add(a.res),a.res=await l(a))})}}}function ds(e,t){for(const[r,n]of Object.entries(t))if(e===r){const s=n[ls];if(s){const i=s.default;if(i)return async(l,c)=>{const a=s[B];return a&&c.set(B,a),c.status(500),i(l,c)}}}}const ps=e=>us({root:"/app/routes",NOT_FOUND:Object.assign({}),ERROR:Object.assign({}),RENDERER:Object.assign({"/app/routes/_renderer.tsx":an}),MIDDLEWARE:Object.assign({}),ROUTES:Object.assign({"/app/routes/api/contact.ts":ns,"/app/routes/index.tsx":is})}),gs=({children:e})=>{const t=nr.getStore();if(!t)throw new Error("No context found");return C(ze,{children:t.get(B)&&e})},vs={"app/client.tsx":{file:"static/client-CFYnUsnY.js",name:"client",src:"app/client.tsx",isEntry:!0}},ys=Object.freeze(Object.defineProperty({__proto__:null,default:vs},Symbol.toStringTag,{value:"Module"})),ms=e=>e.endsWith("/")?e:e+"/",bs=e=>{const t=e.src;if(e.prod??!0){let r=e.manifest;if(!r){const n=Object.assign({"/dist/.vite/manifest.json":ys});for(const[,s]of Object.entries(n))if(s.default){r=s.default;break}}if(r){const n=r[t.replace(/^\//,"")];if(n)return C(gs,{children:C("script",{type:"module",async:!!e.async,src:`${ms("/")}${n.file}`,nonce:e.nonce})})}return C(ze,{})}else return C("script",{type:"module",async:!!e.async,src:t,nonce:e.nonce})},Ze=ps();Ze.use("/api/*",async(e,t)=>{const r=Date.now(),n=e.req.method,s=e.req.path;await t();const i=Date.now()-r;console.log(`[API] ${n} ${s} -> ${e.res.status} (${i}ms)`)});pr(Ze);const ir=new G;ir.get("/",e=>e.text("Hello Hono!"));var Es="x-hono-disable-ssg";(()=>{try{return new Response("SSG is disabled",{status:404,headers:{[Es]:"true"}})}catch{return null}})();var{write:xs}=Bun;const re=new G,or=Object.assign({"/app/server.ts":Ze,"/src/index.ts":ir});let ar=!1;for(const[,e]of Object.entries(or))e&&(re.all("*",t=>{let r;try{r=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,r)}),re.notFound(t=>{let r;try{r=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,r)}),ar=!0);if(!ar)throw new Error("Can't import modules from ['/src/index.ts','/src/index.tsx','/app/server.ts']");let Re;for(const[,e]of Object.entries(or))if(e&&typeof e=="object"&&"websocket"in e&&e.websocket!==void 0){if(Re!==void 0)throw new Error('Handler "websocket" is defined in multiple entry files. Please ensure each handler is defined only once.');Re=e.websocket}const As=Re!==void 0?{fetch:re.fetch.bind(re),websocket:Re}:re;export{As as default};
